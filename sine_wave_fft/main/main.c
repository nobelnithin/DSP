#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "esp_system.h"
#include "driver/spi_master.h"
#include "soc/gpio_struct.h"
#include "driver/gpio.h"
#include "driver/uart.h"
#include "soc/uart_struct.h"
#include <math.h>

#include "esp_dsp.h"

static const char *TAG = "main";

// This example shows how to use FFT from esp-dsp library

#define N_SAMPLES 1024
int N = N_SAMPLES;
// Input test array
__attribute__((aligned(16)))
//float x2[N_SAMPLES];
__attribute__((aligned(16)))
float x1[N_SAMPLES] = {0,0.0613207363022086,0.122410675199216,0.183039887955141,0.242980179903264,0.302005949319228,0.359895036534988,0.416429560097637,0.471396736825998,0.524589682678469,0.575808191417845,0.624859488142386,0.671558954847018,0.715730825283819,0.757208846506485,0.795836904608884,0.831469612302545,0.863972856121587,0.893224301195515,0.919113851690058,0.941544065183021,0.960430519415566,0.975702130038529,0.987301418157858,0.995184726672197,0.999322384588350,0.999698818696204,0.996312612182778,0.989176509964781,0.978317370719628,0.963776065795440,0.945607325380521,0.923879532511287,0.898674465693954,0.870086991108712,0.838224705554838,0.803207531480645,0.765167265622459,0.724247082951467,0.680600997795453,0.634393284163646,0.585797857456439,0.534997619887097,0.482183772079123,0.427555093430282,0.371317193951838,0.313681740398891,0.254865659604515,0.195090322016129,0.134580708507126,0.0735645635996677,0.0122715382857200,-0.0490676743274177,-0.110222207293883,-0.170961888760301,-0.231058108280671,-0.290284677254462,-0.348418680249435,-0.405241314004990,-0.460538710958240,-0.514102744193222,-0.565731810783613,-0.615231590580627,-0.662415777590172,-0.707106781186548,-0.749136394523459,-0.788346427626606,-0.824589302785025,-0.857728610000272,-0.887639620402854,-0.914209755703531,-0.937339011912575,-0.956940335732209,-0.972939952205560,-0.985277642388941,-0.993906970002356,-0.998795456205172,-0.999924701839145,-0.997290456678690,-0.990902635427780,-0.980785280403230,-0.966976471044852,-0.949528180593037,-0.928506080473216,-0.903989293123443,-0.876070094195407,-0.844853565249707,-0.810457198252595,-0.773010453362737,-0.732654271672413,-0.689540544737067,-0.643831542889792,-0.595699304492433,-0.545324988422047,-0.492898192229784,-0.438616238538528,-0.382683432365090,-0.325310292162263,-0.266712757474899,-0.207111376192219,-0.146730474455362,-0.0857973123444403,-0.0245412285229124,0.0368072229413589,0.0980171403295600,0.158858143333861,0.219101240156870,0.278519689385053,0.336889853392220,0.393992040061048,0.449611329654607,0.503538383725718,0.555570233019602,0.605511041404325,0.653172842953777,0.698376249408972,0.740951125354959,0.780737228572094,0.817584813151584,0.851355193105265,0.881921264348355,0.909167983090522,0.932992798834739,0.953306040354194,0.970031253194544,0.983105487431216,0.992479534598710,0.998118112900149,1,0.998118112900149,0.992479534598710,0.983105487431216,0.970031253194544,0.953306040354194,0.932992798834739,0.909167983090522,0.881921264348355,0.851355193105266,0.817584813151584,0.780737228572095,0.740951125354960,0.698376249408973,0.653172842953777,0.605511041404325,0.555570233019602,0.503538383725718,0.449611329654606,0.393992040061048,0.336889853392221,0.278519689385053,0.219101240156870,0.158858143333863,0.0980171403295606,0.0368072229413595,-0.0245412285229127,-0.0857973123444397,-0.146730474455361,-0.207111376192219,-0.266712757474898,-0.325310292162262,-0.382683432365090,-0.438616238538527,-0.492898192229783,-0.545324988422046,-0.595699304492433,-0.643831542889792,-0.689540544737067,-0.732654271672412,-0.773010453362737,-0.810457198252595,-0.844853565249707,-0.876070094195407,-0.903989293123443,-0.928506080473216,-0.949528180593037,-0.966976471044852,-0.980785280403231,-0.990902635427780,-0.997290456678690,-0.999924701839145,-0.998795456205172,-0.993906970002356,-0.985277642388941,-0.972939952205560,-0.956940335732209,-0.937339011912575,-0.914209755703531,-0.887639620402854,-0.857728610000272,-0.824589302785026,-0.788346427626606,-0.749136394523460,-0.707106781186549,-0.662415777590172,-0.615231590580628,-0.565731810783613,-0.514102744193222,-0.460538710958241,-0.405241314004990,-0.348418680249435,-0.290284677254464,-0.231058108280671,-0.170961888760302,-0.110222207293883,-0.0490676743274183,0.0122715382857190,0.0735645635996676,0.134580708507126,0.195090322016127,0.254865659604515,0.313681740398891,0.371317193951836,0.427555093430282,0.482183772079122,0.534997619887097,0.585797857456439,0.634393284163645,0.680600997795453,0.724247082951467,0.765167265622458,0.803207531480645,0.838224705554838,0.870086991108712,0.898674465693954,0.923879532511286,0.945607325380521,0.963776065795440,0.978317370719627,0.989176509964781,0.996312612182778,0.999698818696204,0.999322384588350,0.995184726672197,0.987301418157858,0.975702130038529,0.960430519415566,0.941544065183021,0.919113851690058,0.893224301195516,0.863972856121587,0.831469612302546,0.795836904608885,0.757208846506485,0.715730825283819,0.671558954847018,0.624859488142387,0.575808191417846,0.524589682678469,0.471396736825998,0.416429560097638,0.359895036534988,0.302005949319229,0.242980179903264,0.183039887955141,0.122410675199217,0.0613207363022085,6.12323399573677e-16,-0.0613207363022073,-0.122410675199216,-0.183039887955140,-0.242980179903262,-0.302005949319228,-0.359895036534987,-0.416429560097636,-0.471396736825996,-0.524589682678469,-0.575808191417845,-0.624859488142386,-0.671558954847017,-0.715730825283817,-0.757208846506485,-0.795836904608884,-0.831469612302545,-0.863972856121586,-0.893224301195515,-0.919113851690057,-0.941544065183021,-0.960430519415566,-0.975702130038528,-0.987301418157858,-0.995184726672197,-0.999322384588350,-0.999698818696204,-0.996312612182778,-0.989176509964781,-0.978317370719628,-0.963776065795440,-0.945607325380521,-0.923879532511287,-0.898674465693954,-0.870086991108712,-0.838224705554839,-0.803207531480645,-0.765167265622459,-0.724247082951467,-0.680600997795454,-0.634393284163647,-0.585797857456438,-0.534997619887097,-0.482183772079123,-0.427555093430283,-0.371317193951839,-0.313681740398894,-0.254865659604514,-0.195090322016128,-0.134580708507127,-0.0735645635996688,-0.0122715382857220,0.0490676743274189,0.110222207293883,0.170961888760301,0.231058108280670,0.290284677254461,0.348418680249432,0.405241314004990,0.460538710958240,0.514102744193221,0.565731810783612,0.615231590580625,0.662415777590172,0.707106781186548,0.749136394523459,0.788346427626606,0.824589302785024,0.857728610000271,0.887639620402854,0.914209755703531,0.937339011912575,0.956940335732208,0.972939952205560,0.985277642388941,0.993906970002356,0.998795456205172,0.999924701839145,0.997290456678690,0.990902635427780,0.980785280403230,0.966976471044852,0.949528180593037,0.928506080473216,0.903989293123444,0.876070094195406,0.844853565249707,0.810457198252595,0.773010453362738,0.732654271672414,0.689540544737066,0.643831542889791,0.595699304492434,0.545324988422047,0.492898192229786,0.438616238538530,0.382683432365089,0.325310292162263,0.266712757474899,0.207111376192220,0.146730474455364,0.0857973123444391,0.0245412285229122,-0.0368072229413583,-0.0980171403295594,-0.158858143333860,-0.219101240156867,-0.278519689385054,-0.336889853392220,-0.393992040061047,-0.449611329654605,-0.503538383725716,-0.555570233019603,-0.605511041404326,-0.653172842953776,-0.698376249408972,-0.740951125354958,-0.780737228572093,-0.817584813151584,-0.851355193105265,-0.881921264348355,-0.909167983090522,-0.932992798834738,-0.953306040354194,-0.970031253194544,-0.983105487431216,-0.992479534598710,-0.998118112900149,-1,-0.998118112900149,-0.992479534598710,-0.983105487431217,-0.970031253194544,-0.953306040354195,-0.932992798834739,-0.909167983090523,-0.881921264348355,-0.851355193105266,-0.817584813151585,-0.780737228572094,-0.740951125354959,-0.698376249408973,-0.653172842953778,-0.605511041404327,-0.555570233019604,-0.503538383725717,-0.449611329654607,-0.393992040061049,-0.336889853392222,-0.278519689385055,-0.219101240156869,-0.158858143333861,-0.0980171403295612,-0.0368072229413601,0.0245412285229103,0.0857973123444373,0.146730474455362,0.207111376192218,0.266712757474897,0.325310292162261,0.382683432365088,0.438616238538528,0.492898192229784,0.545324988422046,0.595699304492432,0.643831542889790,0.689540544737065,0.732654271672413,0.773010453362737,0.810457198252594,0.844853565249706,0.876070094195406,0.903989293123444,0.928506080473216,0.949528180593037,0.966976471044852,0.980785280403230,0.990902635427780,0.997290456678690,0.999924701839145,0.998795456205172,0.993906970002356,0.985277642388942,0.972939952205560,0.956940335732209,0.937339011912575,0.914209755703531,0.887639620402855,0.857728610000272,0.824589302785025,0.788346427626607,0.749136394523460,0.707106781186549,0.662415777590174,0.615231590580627,0.565731810783614,0.514102744193223,0.460538710958242,0.405241314004992,0.348418680249434,0.290284677254462,0.231058108280672,0.170961888760303,0.110222207293885,0.0490676743274207,-0.0122715382857201,-0.0735645635996670,-0.134580708507125,-0.195090322016127,-0.254865659604512,-0.313681740398892,-0.371317193951837,-0.427555093430281,-0.482183772079121,-0.534997619887095,-0.585797857456437,-0.634393284163646,-0.680600997795453,-0.724247082951466,-0.765167265622458,-0.803207531480643,-0.838224705554838,-0.870086991108711,-0.898674465693954,-0.923879532511286,-0.945607325380521,-0.963776065795439,-0.978317370719628,-0.989176509964781,-0.996312612182778,-0.999698818696204,-0.999322384588350,-0.995184726672197,-0.987301418157858,-0.975702130038529,-0.960430519415566,-0.941544065183022,-0.919113851690058,-0.893224301195515,-0.863972856121587,-0.831469612302546,-0.795836904608885,-0.757208846506486,-0.715730825283819,-0.671558954847019,-0.624859488142387,-0.575808191417847,-0.524589682678471,-0.471396736825997,-0.416429560097637,-0.359895036534989,-0.302005949319230,-0.242980179903266,-0.183039887955144,-0.122410675199216,-0.0613207363022092,-1.22464679914735e-15,0.0613207363022067,0.122410675199214,0.183039887955141,0.242980179903264,0.302005949319227,0.359895036534987,0.416429560097635,0.471396736825995,0.524589682678469,0.575808191417845,0.624859488142385,0.671558954847017,0.715730825283817,0.757208846506482,0.795836904608881,0.831469612302543,0.863972856121588,0.893224301195516,0.919113851690058,0.941544065183021,0.960430519415566,0.975702130038528,0.987301418157858,0.995184726672197,0.999322384588349,0.999698818696204,0.996312612182778,0.989176509964781,0.978317370719627,0.963776065795440,0.945607325380521,0.923879532511287,0.898674465693955,0.870086991108713,0.838224705554840,0.803207531480647,0.765167265622462,0.724247082951470,0.680600997795452,0.634393284163645,0.585797857456439,0.534997619887098,0.482183772079124,0.427555093430284,0.371317193951840,0.313681740398894,0.254865659604518,0.195090322016132,0.134580708507131,0.0735645635996659,0.0122715382857190,-0.0490676743274183,-0.110222207293883,-0.170961888760300,-0.231058108280669,-0.290284677254460,-0.348418680249432,-0.405241314004987,-0.460538710958236,-0.514102744193224,-0.565731810783615,-0.615231590580628,-0.662415777590172,-0.707106781186547,-0.749136394523459,-0.788346427626605,-0.824589302785024,-0.857728610000271,-0.887639620402852,-0.914209755703529,-0.937339011912576,-0.956940335732209,-0.972939952205560,-0.985277642388941,-0.993906970002356,-0.998795456205172,-0.999924701839145,-0.997290456678690,-0.990902635427781,-0.980785280403231,-0.966976471044853,-0.949528180593036,-0.928506080473215,-0.903989293123443,-0.876070094195407,-0.844853565249707,-0.810457198252596,-0.773010453362738,-0.732654271672415,-0.689540544737069,-0.643831542889795,-0.595699304492437,-0.545324988422045,-0.492898192229783,-0.438616238538527,-0.382683432365090,-0.325310292162264,-0.266712757474900,-0.207111376192221,-0.146730474455364,-0.0857973123444433,-0.0245412285229163,0.0368072229413541,0.0980171403295623,0.158858143333863,0.219101240156870,0.278519689385053,0.336889853392219,0.393992040061047,0.449611329654605,0.503538383725715,0.555570233019599,0.605511041404322,0.653172842953773,0.698376249408974,0.740951125354960,0.780737228572095,0.817584813151584,0.851355193105265,0.881921264348354,0.909167983090522,0.932992798834738,0.953306040354193,0.970031253194543,0.983105487431215,0.992479534598710,0.998118112900149,1,0.998118112900149,0.992479534598710,0.983105487431217,0.970031253194545,0.953306040354195,0.932992798834740,0.909167983090524,0.881921264348357,0.851355193105264,0.817584813151583,0.780737228572094,0.740951125354959,0.698376249408974,0.653172842953778,0.605511041404327,0.555570233019605,0.503538383725721,0.449611329654611,0.393992040061053,0.336889853392219,0.278519689385052,0.219101240156870,0.158858143333862,0.0980171403295619,0.0368072229413607,-0.0245412285229097,-0.0857973123444367,-0.146730474455358,-0.207111376192214,-0.266712757474900,-0.325310292162264,-0.382683432365090,-0.438616238538528,-0.492898192229783,-0.545324988422045,-0.595699304492432,-0.643831542889789,-0.689540544737065,-0.732654271672410,-0.773010453362734,-0.810457198252596,-0.844853565249708,-0.876070094195407,-0.903989293123443,-0.928506080473215,-0.949528180593036,-0.966976471044852,-0.980785280403230,-0.990902635427780,-0.997290456678690,-0.999924701839145,-0.998795456205172,-0.993906970002356,-0.985277642388941,-0.972939952205560,-0.956940335732209,-0.937339011912576,-0.914209755703532,-0.887639620402855,-0.857728610000274,-0.824589302785028,-0.788346427626609,-0.749136394523458,-0.707106781186547,-0.662415777590172,-0.615231590580627,-0.565731810783614,-0.514102744193223,-0.460538710958242,-0.405241314004993,-0.348418680249438,-0.290284677254466,-0.231058108280676,-0.170961888760300,-0.110222207293882,-0.0490676743274178,0.0122715382857195,0.0735645635996663,0.134580708507124,0.195090322016126,0.254865659604512,0.313681740398888,0.371317193951834,0.427555093430278,0.482183772079124,0.534997619887098,0.585797857456439,0.634393284163645,0.680600997795452,0.724247082951466,0.765167265622457,0.803207531480643,0.838224705554836,0.870086991108709,0.898674465693952,0.923879532511287,0.945607325380522,0.963776065795440,0.978317370719628,0.989176509964781,0.996312612182778,0.999698818696204,0.999322384588350,0.995184726672197,0.987301418157859,0.975702130038530,0.960430519415566,0.941544065183021,0.919113851690058,0.893224301195516,0.863972856121588,0.831469612302546,0.795836904608885,0.757208846506487,0.715730825283822,0.671558954847022,0.624859488142391,0.575808191417844,0.524589682678469,0.471396736825998,0.416429560097638,0.359895036534990,0.302005949319230,0.242980179903267,0.183039887955144,0.122410675199220,0.0613207363022133,5.38968387752153e-15,-0.0613207363022096,-0.122410675199217,-0.183039887955141,-0.242980179903263,-0.302005949319227,-0.359895036534986,-0.416429560097635,-0.471396736825995,-0.524589682678465,-0.575808191417841,-0.624859488142388,-0.671558954847019,-0.715730825283819,-0.757208846506484,-0.795836904608883,-0.831469612302544,-0.863972856121586,-0.893224301195514,-0.919113851690056,-0.941544065183019,-0.960430519415565,-0.975702130038529,-0.987301418157859,-0.995184726672197,-0.999322384588349,-0.999698818696204,-0.996312612182778,-0.989176509964781,-0.978317370719628,-0.963776065795441,-0.945607325380523,-0.923879532511289,-0.898674465693953,-0.870086991108711,-0.838224705554838,-0.803207531480645,-0.765167265622460,-0.724247082951468,-0.680600997795455,-0.634393284163648,-0.585797857456442,-0.534997619887101,-0.482183772079127,-0.427555093430281,-0.371317193951837,-0.313681740398891,-0.254865659604515,-0.195090322016130,-0.134580708507128,-0.0735645635996700,-0.0122715382857232,0.0490676743274141,0.110222207293879,0.170961888760296,0.231058108280672,0.290284677254463,0.348418680249435,0.405241314004989,0.460538710958239,0.514102744193220,0.565731810783611,0.615231590580624,0.662415777590169,0.707106781186544,0.749136394523456,0.788346427626607,0.824589302785026,0.857728610000272,0.887639620402854,0.914209755703530,0.937339011912574,0.956940335732208,0.972939952205559,0.985277642388941,0.993906970002356,0.998795456205172,0.999924701839145,0.997290456678690,0.990902635427780,0.980785280403231,0.966976471044853,0.949528180593037,0.928506080473217,0.903989293123445,0.876070094195409,0.844853565249710,0.810457198252598,0.773010453362736,0.732654271672413,0.689540544737067,0.643831542889792,0.595699304492435,0.545324988422048,0.492898192229787,0.438616238538531,0.382683432365094,0.325310292162268,0.266712757474904,0.207111376192218,0.146730474455362,0.0857973123444403,0.0245412285229134,-0.0368072229413571,-0.0980171403295582,-0.158858143333858,-0.219101240156866,-0.278519689385049,-0.336889853392215,-0.393992040061049,-0.449611329654607,-0.503538383725718,-0.555570233019602,-0.605511041404325,-0.653172842953775,-0.698376249408971,-0.740951125354957,-0.780737228572092,-0.817584813151581,-0.851355193105262,-0.881921264348356,-0.909167983090523,-0.932992798834739,-0.953306040354194,-0.970031253194544,-0.983105487431216,-0.992479534598710,-0.998118112900149,-1,-0.998118112900150,-0.992479534598711,-0.983105487431216,-0.970031253194544,-0.953306040354194,-0.932992798834739,-0.909167983090523,-0.881921264348356,-0.851355193105267,-0.817584813151586,-0.780737228572097,-0.740951125354962,-0.698376249408977,-0.653172842953776,-0.605511041404325,-0.555570233019602,-0.503538383725718,-0.449611329654608,-0.393992040061050,-0.336889853392223,-0.278519689385056,-0.219101240156874,-0.158858143333866,-0.0980171403295660,-0.0368072229413578,0.0245412285229127,0.0857973123444396,0.146730474455361,0.207111376192217,0.266712757474896,0.325310292162260,0.382683432365087,0.438616238538524,0.492898192229780,0.545324988422042,0.595699304492434,0.643831542889792,0.689540544737067,0.732654271672412,0.773010453362736,0.810457198252593,0.844853565249706,0.876070094195405,0.903989293123442,0.928506080473214,0.949528180593035,0.966976471044852,0.980785280403230,0.990902635427780,0.997290456678690,0.999924701839145,0.998795456205173,0.993906970002356,0.985277642388942,0.972939952205561,0.956940335732210,0.937339011912577,0.914209755703530,0.887639620402854,0.857728610000272,0.824589302785026,0.788346427626607,0.749136394523461,0.707106781186550,0.662415777590175,0.615231590580630,0.565731810783618,0.514102744193227,0.460538710958239,0.405241314004990,0.348418680249435,0.290284677254464,0.231058108280673,0.170961888760304,0.110222207293886,0.0490676743274219,-0.0122715382857153,-0.0735645635996622,-0.134580708507127,-0.195090322016129,-0.254865659604514,-0.313681740398891,-0.371317193951836,-0.427555093430280,-0.482183772079120,-0.534997619887094,-0.585797857456436,-0.634393284163642,-0.680600997795449,-0.724247082951468,-0.765167265622459,-0.803207531480645,-0.838224705554838,-0.870086991108711,-0.898674465693953,-0.923879532511286,-0.945607325380520,-0.963776065795439,-0.978317370719627,-0.989176509964780,-0.996312612182778,-0.999698818696204,-0.999322384588350,-0.995184726672197,-0.987301418157859,-0.975702130038529,-0.960430519415567,-0.941544065183022,-0.919113851690059,-0.893224301195518,-0.863972856121590,-0.831469612302545,-0.795836904608883,-0.757208846506485,-0.715730825283819,-0.671558954847020,-0.624859488142388,-0.575808191417848,-0.524589682678472,-0.471396736826002,-0.416429560097642,-0.359895036534993,-0.302005949319227,-0.242980179903264,-0.183039887955141,-0.122410675199217,-0.0613207363022104};
// Window coefficients
__attribute__((aligned(16)))
float wind[N_SAMPLES];
// working complex array
__attribute__((aligned(16)))   
float y_cf[N_SAMPLES * 2];
// Pointers to result arrays
float *y1_cf = &y_cf[0];
float *y2_cf = &y_cf[N_SAMPLES];

// Sum of y1 and y2
__attribute__((aligned(16)))
float sum_y[N_SAMPLES / 2];

void app_main()
{
    esp_err_t ret;
    ESP_LOGI(TAG, "Start Example.");
    ret = dsps_fft2r_init_fc32(NULL, CONFIG_DSP_MAX_FFT_SIZE);
    if (ret  != ESP_OK) {
        ESP_LOGE(TAG, "Not possible to initialize FFT. Error = %i", ret);
        return;
    }

    // Generate hann window
    dsps_wind_hann_f32(wind, N);
    // Generate input signal for x1 A=1 , F=0.1
    //dsps_tone_gen_f32(x1, N, 1.0, 0.16,  0);
    // Generate input signal for x2 A=0.1,F=0.2
    //dsps_tone_gen_f32(x2, N, 0.1, 0.2, 0);

    // Convert two input vectors to one complex vector
    for (int i = 0 ; i < N ; i++) {
        y_cf[i] = x1[i] * wind[i];
        //y_cf[i * 2 + 1] = x2[i] * wind[i];
    }
    // FFT
    unsigned int start_b = dsp_get_cpu_cycle_count();
    dsps_fft2r_fc32(y_cf, N);


    // dsps_view(y_cf, N , 64, 10,  -60, 40, '|');
    unsigned int end_b = dsp_get_cpu_cycle_count();
    // Bit reverse
    dsps_bit_rev_fc32(y_cf, N);
    // Convert one complex vector to two complex vectors

    dsps_cplx2reC_fc32(y_cf, N);


    for (int i = 0 ; i < N / 2 ; i++) {
        y1_cf[i] = 10 * log10f((y1_cf[i * 2 + 0] * y1_cf[i * 2 + 0] + y1_cf[i * 2 + 1] * y1_cf[i * 2 + 1]) / N);
        y2_cf[i] = 10 * log10f((y2_cf[i * 2 + 0] * y2_cf[i * 2 + 0] + y2_cf[i * 2 + 1] * y2_cf[i * 2 + 1]) / N);
        // Simple way to show two power spectrums as one plot
        //sum_y[i] = fmax(y1_cf[i], y2_cf[i]);
    }

    // Show power spectrum in 64x10 window from -100 to 0 dB from 0..N/4 samples
    ESP_LOGW(TAG, "Signal x1");
    dsps_view(y1_cf, N , 64, 10,  -60, 40, '|');
    ESP_LOGW(TAG, "Signal x2");
     dsps_view(y2_cf, N / 2, 64, 10,  -60, 40, '|');
    ESP_LOGW(TAG, "Signals x1 and x2 on one plot");
   // dsps_view(sum_y, N / 2, 64, 10,  -60, 40, '|');
    ESP_LOGI(TAG, "FFT for %i complex points take %i cycles", N, end_b - start_b);

    ESP_LOGI(TAG, "End Example.");
}